@model TrangChuViewModel

@{
    ViewData["Title"] = "SingleProduct Page";
    ViewBag.PageName = "SingleProduct";
}

<!-- Slider Area -->
<div class="slider-area">
    <!-- Slider -->
    <div class="block-slider block-slider4">
        <ul id="bxslider-home4">
            <li>
                <img src="img/h4-slide.png" alt="Slide">
                <div class="caption-group">
                    <h2 class="caption title">
                        iPhone <span class="primary">6 <strong>Plus</strong></span>
                    </h2>
                    <h4 class="caption subtitle">Dual SIM</h4>
                    <a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
                </div>
            </li>
            <li>
                <img src="img/h4-slide2.png" alt="Slide">
                <div class="caption-group">
                    <h2 class="caption title">
                        by one, get one <span class="primary">50% <strong>off</strong></span>
                    </h2>
                    <h4 class="caption subtitle">school supplies & backpacks.*</h4>
                    <a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
                </div>
            </li>
            <li>
                <img src="img/h4-slide3.png" alt="Slide">
                <div class="caption-group">
                    <h2 class="caption title">
                        Apple <span class="primary">Store <strong>Ipod</strong></span>
                    </h2>
                    <h4 class="caption subtitle">Select Item</h4>
                    <a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
                </div>
            </li>
            <li>
                <img src="img/h4-slide4.png" alt="Slide">
                <div class="caption-group">
                    <h2 class="caption title">
                        Apple <span class="primary">Store <strong>Ipod</strong></span>
                    </h2>
                    <h4 class="caption subtitle">& Phone</h4>
                    <a class="caption button-radius" href="#"><span class="icon"></span>Shop now</a>
                </div>
            </li>
        </ul>
    </div>
    @* End Slider *@
</div>
@* End slider area *@

<!-- Promo Area -->
<div class="promo-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo1">
                    <i class="fa fa-refresh"></i>
                    <p>30 Days return</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo2">
                    <i class="fa fa-truck"></i>
                    <p>Free shipping</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo3">
                    <i class="fa fa-lock"></i>
                    <p>Secure payments</p>
                </div>
            </div>
            <div class="col-md-3 col-sm-6">
                <div class="single-promo promo4">
                    <i class="fa fa-gift"></i>
                    <p>New products</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Latest Products -->
<div class="latest-product">
    <h2 class="section-title">Latest Products</h2>
    @* Hiển thị sản phẩm mới nhất *@
    <div class="product-carousel" style="display:flex; flex-wrap:wrap; gap:20px;">
        @if (Model.LatestProducts != null && Model.LatestProducts.Any())
        {
            @foreach (var product in Model.LatestProducts)
            {
                <div class="single-product" style="text-align:center; margin-bottom:20px; flex:1 1 220px; position:relative;">
                    <div class="product-f-image" style="position:relative; overflow:hidden;">
                        <img src="@product.ThumbnailUrl" alt="@product.ProductName"
                             style="width:100%; height:300px; object-fit:cover; display:block; background-color:#f2f2f2;"
                             onerror="this.src='/User/img/default-product.jpg';" />
                        <div class="product-hover" style="position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); color:#fff; opacity:0; transition:opacity 0.3s; display:flex; flex-direction:column; justify-content:center; align-items:center;">
                            <a href="#" class="add-to-cart-link" onclick="addToCart(@product.ProductID)" style="margin-bottom:10px; color:#fff; text-decoration:none; padding:8px 12px; background:#ff6f61; border-radius:4px;">
                                <i class="fa fa-shopping-cart"></i> Add to cart
                            </a>
                            <a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })" class="view-Index-link" style="color:#fff; text-decoration:none; padding:8px 12px; border:1px solid #fff; border-radius:4px;">
                                <i class="fa fa-link"></i> See Index
                            </a>
                        </div>
                    </div>
                    <h2 style="margin-top:10px;">
                        <a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">@product.ProductName</a>
                    </h2>
                    <div class="product-carousel-price">
                        <ins>@((product.PriceSale ?? product.Price).ToString("N0")) VNĐ</ins>
                        @if (product.PriceSale.HasValue && product.PriceSale < product.Price)
                        {
                            <del>@(product.Price.ToString("N0")) VNĐ</del>
                        }
                    </div>
                </div>
            }
        }
        else
        {
            <p>Chưa có sản phẩm mới (check DB).</p>
        }
    </div>
</div>

<script>
    // JS hover hiển thị nút Add to cart / See Index
    document.querySelectorAll('.product-f-image').forEach(function(item){
        item.addEventListener('mouseenter', function(){
            this.querySelector('.product-hover').style.opacity = 1;
        });
        item.addEventListener('mouseleave', function(){
            this.querySelector('.product-hover').style.opacity = 0;
        });
    });
</script>

<!-- Brands Area -->
<div class="brands-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="brand-wrapper">
                    <div class="brand-list" style="display:flex; flex-wrap:wrap; gap:15px; justify-content:center;">
                        @for (int i = 1; i <= 6; i++)
                        {
                            <img src="/User/img/brand@i.png" alt="" style="max-width:120px; height:auto; object-fit:contain;" />
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Product Widget Area -->
<div class="product-widget-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <!-- Top Sellers -->
            <div class="col-md-4 col-sm-6">
                <div class="single-product-widget">
                    <h2 class="product-wid-title">Top Sellers</h2>
                    <a href="" class="wid-view-more">View All</a>
                    @* Hiển thị sản phẩm bán chạy *@
                    @if (Model.TopSellers != null && Model.TopSellers.Any())
                    {
                        @foreach (var product in Model.TopSellers)
                        {
                            <div class="single-wid-product" style="text-align:center; margin-bottom:20px; display:flex; flex-direction:column; align-items:center;">
                                <a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">
                                    <img src="@product.ThumbnailUrl" alt="" class="product-thumb"
                                         style="width:100%; max-width:100px; height:auto; object-fit:cover; background-color:#f2f2f2;"
                                         onerror="this.src='/User/img/default-thumb.jpg';" />
                                </a>
                                <h2><a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">@product.ProductName</a></h2>
                                <div class="product-wid-rating">
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                                <div class="product-wid-price">
                                    <ins>@((product.PriceSale ?? product.Price).ToString("N0")) VNĐ</ins>
                                    @if (product.PriceSale.HasValue && product.PriceSale < product.Price)
                                    {
                                        <del>@(product.Price.ToString("N0")) VNĐ</del>
                                    }
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <p>Chưa có sản phẩm bán chạy.</p>
                    }
                </div>
            </div>

            <!-- Recently Viewed -->
            <div class="col-md-4 col-sm-6">
                <div class="single-product-widget">
                    <h2 class="product-wid-title">Recently Viewed</h2>
                    <a href="#" class="wid-view-more">View All</a>
                    @* Hiển thị sản phẩm vừa xem *@
                    @if (Model.RecentlyViewed != null && Model.RecentlyViewed.Any())
                    {
                        @foreach (var product in Model.RecentlyViewed)
                        {
                            <div class="single-wid-product" style="text-align:center; margin-bottom:20px; display:flex; flex-direction:column; align-items:center;">
                                <a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">
                                    <img src="@product.ThumbnailUrl" alt="" class="product-thumb"
                                         style="width:100%; max-width:100px; height:auto; object-fit:cover; background-color:#f2f2f2;"
                                         onerror="this.src='/User/img/default-thumb.jpg';" />
                                </a>
                                <h2><a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">@product.ProductName</a></h2>
                                <div class="product-wid-rating">
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                                <div class="product-wid-price">
                                    <ins>@((product.PriceSale ?? product.Price).ToString("N0")) VNĐ</ins>
                                    @if (product.PriceSale.HasValue && product.PriceSale < product.Price)
                                    {
                                        <del>@(product.Price.ToString("N0")) VNĐ</del>
                                    }
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <p>Chưa có sản phẩm đã xem.</p>
                    }
                </div>
            </div>

            <!-- Top New -->
            <div class="col-md-4 col-sm-6">
                <div class="single-product-widget">
                    <h2 class="product-wid-title">Top New</h2>
                    <a href="#" class="wid-view-more">View All</a>
                    @* Hiển thị sản phẩm mới thêm vào kho *@
                    @if (Model.TopNew != null && Model.TopNew.Any())
                    {
                        @foreach (var product in Model.TopNew)
                        {
                            <div class="single-wid-product" style="text-align:center; margin-bottom:20px; display:flex; flex-direction:column; align-items:center;">
                                <a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">
                                    <img src="@product.ThumbnailUrl" alt="" class="product-thumb"
                                         style="width:100%; max-width:100px; height:auto; object-fit:cover; background-color:#f2f2f2;"
                                         onerror="this.src='/User/img/default-thumb.jpg';" />
                                </a>
                                <h2><a href="@Url.Action("Index", "SingleProduct", new { id = product.ProductID })">@product.ProductName</a></h2>
                                <div class="product-wid-rating">
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i><i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                </div>
                                <div class="product-wid-price">
                                    <ins>@((product.PriceSale ?? product.Price).ToString("N0")) VNĐ</ins>
                                    @if (product.PriceSale.HasValue && product.PriceSale < product.Price)
                                    {
                                        <del>@(product.Price.ToString("N0")) VNĐ</del>
                                    }
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <p>Chưa có sản phẩm mới.</p>
                    }
                </div>
            </div>

        </div>
    </div>
</div>
